
checkfile.sh 为检查文件是否被植入病毒的脚本。执行日志存放在check 这个文件夹下
checkwebhack.sh 为在web程序目录根日志目录查找入侵痕迹的脚本。执行日志存放在web程序目录下的checkweb.log

网络情况不好的时候要自己编译脚本中的工具。看情况使用。

一、unhide
编译
If you ARE using a Linux kernel >= 2.6
      gcc -Wall -O2 --static -pthread unhide-linux*.c unhide-output.c -o unhide-linux
      gcc -Wall -O2 --static unhide_rb.c -o unhide_rb
      gcc -Wall -O2 --static unhide-tcp.c unhide-tcp-fast.c unhide-output.c -o unhide-tcp
      ln -s unhide unhide-linux

Else (Linux < 2.6, *BSD, Solaris and other Unice)
      gcc --static unhide-posix.c -o unhide-posix
      ln -s unhide unhide-posix

使用
nohup unhide sys >>check/unhide.log
nohup unhide brute >>check/unhide.log
nohup unhide proc >>check/unhide.log
nohup unhide procall >>check/unhide.log
nohup unhide procfs >>check/unhide.log
nohup unhide quick >>check/unhide.log
nohup unhide reverse >>check/unhide.log
nohup unhide-tcp >>check/unhide.log

二、rkhunter
安装
    ./installer.sh --install

使用
rkhunter -c --sk >>check/rkhunter.log 

三、chkrootkit

chkrootkit文件夹是编译好的可执行文件
使用
./chkrootkit -p commands #commands是一个存放原生命令的目录。检查过程中调用这个目录里面的命令而不再使用系统命令（有被篡改的风险）。

四、clamav
编译
./configure
make && make install

使用
配置文件
1、配置/etc/clam.conf文件

#cd /opt/clamav
#vi etc/clam.conf
# Example 注释掉这一行. 第8 行　　
 LogFile /opt/clamav/logs/clamd.log              删掉前面的注释目录改为logs下面 第14行
 /opt/clamav/updata/clamd.pid           删掉前面的注释路径改一下 第57行
 /opt/clamav/updata 同上 第65行

2、配置freshclam.conf文件

#vi etc/freshclam.conf
#Example 注释掉这一行
DatabaseDirectory /opt/clamav/updata
UpdateLogFile /opt/clamav/logs/freshclam.log
PidFile /opt/clamav/updata/freshclam.pid	



1、升级
#/opt/clamav/bin/freshclam        (升级病毒库)   保证你的LINUX可以正常上网哦.
2、杀毒

#/opt/clamav/bin/clamscan        --查杀当前目录下的文件
#/opt/clamav/bin/clamscan -r     --查杀当前目录的所有文件及目录 
#/opt/clamav/bin/clamscan dir    --查杀dir目录 
#/opt/clamav/bin/clamscan -r dir --查杀目录dir下的所有文件及目录